{% load static %}

<div class="offcanvas-body" id="cartItemsContainer">
        {% if cart_items %}
          {% for item in cart_items %}
          <div class="container d-flex align-items-start mb-3 border-bottom pb-2">
            
            <!-- Image Column -->
            <div class="container-fluid me-3" style="max-width: 100px;">
              <img src="{{ item.image_url }}" 
                  class="img-fluid rounded shadow" 
                  style="width: 100%; height: 100%; object-fit: cover;" 
                  alt="{{ item.product_name }} image">
            </div>

            <!-- Info Column -->
            <div class="container-fluid">
              <strong>{{ item.product_name }}</strong><br>
              Size: {{ item.size }}<br>
              Color: {{ item.color }}<br>

            <!-- Quantity Update Form -->
            <form method="POST" 
                  action="{% url 'update_cart_quantity' item.product_id item.size %}" 
                  class="d-flex align-items-center mt-2">
              {% csrf_token %}
              
              <!-- Minus Button -->
              <button type="button" class="btn btn-outline-secondary btn-sm me-1" onclick="changeQuantity(this, -1)">−</button>
              
              <!-- Quantity Input -->
              <input class="quantityUpdate text-center" type="number" 
                    name="quantity" 
                    value="{{ item.quantity }}" 
                    min="1" 
                    max="50"
                    class="form-control form-control-sm text-center me-1" 
                    style="width: 30px;"
                    onchange="this.form.submit()">

              <!-- Plus Button -->
              <button type="button" class="btn btn-outline-secondary btn-sm ms-1" onclick="changeQuantity(this, 1)">+</button>
            </form>
              <span class="d-block mt-2">
                Price: ₱{{ item.price }}<br>
                Subtotal: <strong class="text-success">₱{{ item.subtotal }}</strong>
              </span>

              <!-- Remove Button -->
              <form method="POST" action="{% url 'remove_from_cart' item.product_id item.size %}">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger btn-sm mt-2">
                  <img src="{% static 'images/trashcanSVG.svg' %}" alt="DELETE" style="width: 20px;">
                </button>
              </form>
            </div>
          </div>
          {% endfor %}

          <!-- Total -->
          <div class="border-top pt-3 mt-3 text-end">
            <h5>Total: <span class="text-success">₱{{ total_price }}</span></h5>
            <a href="{% url 'checkout' %}" class="btn btn-success w-100 mt-3">Proceed to Checkout</a>
          </div>
        {% else %}
          <p>Your cart is empty.</p>
        {% endif %}
      </div>