{% extends 'adminBase.html' %}
{% load static %}
{% block title %} {% if edit_prodname %}Update Product Name{% else %}Create Product Name{% endif %} {% endblock %}
{% block content %}

<main class="flex-grow-1 overflow-auto p-4 p-md-5">
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-success">{{ message }}</div>
        {% endfor %}
    {% endif %}
    <div class="container">
        <h2 class="text-light mb-4 text-center">
            {% if edit_prodname %}
                Update Product Name
            {% else %}
                Add Product Name
            {% endif %}
        </h2>
    </div>

    <div class="container">
        <form method="post" class="card card-body bg-dark text-light shadow-sm mb-5" id="prodNameForm">
            {% csrf_token %}
            {% if edit_prodname %}
                <input type="hidden" name="prodnameid" value="{{ edit_prodname.prodnameid }}">
            {% endif %}
            <div class="mb-3">
                {{ form.name.label_tag }}
                {{ form.name }}
            </div>
            <button type="submit" class="btn btn-{{ edit_prodname|yesno:'primary,success' }}" id="submitBtn">
                {% if edit_prodname %}Update{% else %}Add{% endif %}
            </button>
            {% if edit_prodname %}
                <a href="{% url 'newProductName' %}" class="btn btn-secondary ms-2">Cancel</a>
            {% endif %}
        </form>
    </div>

    <table class="table table-dark table-striped table-bordered table-hover text-center align-middle shadow-sm mt-4">
        <thead>
            <tr>
                <th class="text-light fw-bold">Product Name ID</th>
                <th class="text-light fw-bold">Product Name</th>
                <th class="text-light fw-bold">Actions</th>
            </tr>
        </thead>
        <tbody class="text-light">
            {% for prod in product_names %}
            <tr>
                <td>{{ prod.prodnameid }}</td>
                <td>{{ prod.name }}</td>
                <td>
                    <a href="?edit={{ prod.prodnameid }}" class="btn btn-sm btn-primary">Edit</a>

                    <form method="post" class="d-inline" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" name="delete_prodnameid" value="{{ prod.prodnameid }}" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure you want to delete this product name?');">
                            Delete
                        </button>
                    </form>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="3">No product names found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

</main>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const input = document.querySelector('#id_name');  // Django default id for 'name' field in form
    const submitBtn = document.getElementById('submitBtn');

    function toggleButton() {
        if (input.value.trim() === '') {
            submitBtn.disabled = true;
        } else {
            submitBtn.disabled = false;
        }
    }

    // Initial check
    toggleButton();

    // Listen for input changes
    input.addEventListener('input', toggleButton);
});
</script>

{% endblock %}
